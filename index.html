<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NASA Space Dashboard</title>
<style>
  body { margin:0; font-family:sans-serif; background: #000; color:white; overflow-x:hidden; }
  h1 { text-align:center; margin-top:10px; }
  #apod, #roverGallery, #quiz { margin:20px auto; text-align:center; max-width:90%; }
  #apod img, .roverImg { max-width:300px; border:2px solid white; border-radius:10px; margin:10px; cursor:pointer; }
  #solarSystemCanvas { display:block; margin:20px auto; width:90%; height:400px; border:1px solid white; }
  #planetInfo, #quizResult { text-align:center; margin-top:10px; font-size:16px; }
  button { margin:5px; padding:10px 15px; font-size:16px; cursor:pointer; border-radius:5px; }
</style>
</head>
<body>

<h1>NASA Space Dashboard</h1>

<div id="apod">
  <h2>Astronomy Picture of the Day</h2>
  <p id="apodTitle"></p>
  <img id="apodImage" src="" alt="NASA APOD">
  <p id="apodDesc"></p>
</div>

<canvas id="solarSystemCanvas"></canvas>
<div id="planetInfo">Click on a planet to learn a fact!</div>

<div id="roverGallery">
  <h2>Mars Rover Photos</h2>
  <div id="roverImages"></div>
</div>

<div id="quiz">
  <h2>Space Quiz!</h2>
  <div id="question"></div>
  <div id="options"></div>
  <p id="quizResult"></p>
  <button id="nextQ" style="display:none;">Next Question</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<script>
const apiKey = "J7iawHQ0xIEe35aj39BlqIk8mF8sUx2hqn2QSTJC";

async function loadAPOD(){
  try{
    const res = await fetch(`https://api.nasa.gov/planetary/apod?api_key=${apiKey}`);
    const data = await res.json();
    document.getElementById("apodTitle").innerText = data.title;
    document.getElementById("apodImage").src = data.url;
    document.getElementById("apodDesc").innerText = data.explanation;
  }catch(err){
    document.getElementById("apodTitle").innerText = "Failed to load APOD.";
    console.error(err);
  }
}
loadAPOD();

const canvas = document.getElementById("solarSystemCanvas");
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);
const camera = new THREE.PerspectiveCamera(45, canvas.clientWidth/canvas.clientHeight, 0.1, 1000);
camera.position.set(0,20,40);
const renderer = new THREE.WebGLRenderer({canvas});
renderer.setSize(canvas.clientWidth, canvas.clientHeight);
const controls = new THREE.OrbitControls(camera, renderer.domElement);
const light = new THREE.PointLight(0xffffff,1);
light.position.set(0,0,0);
scene.add(light);

const sun = new THREE.Mesh(new THREE.SphereGeometry(3,32,32), new THREE.MeshBasicMaterial({color:0xffff00}));
scene.add(sun);

const planetsData = [
  {name:"Mercury", distance:5, color:0xaaaaaa, size:0.5, fact:"Mercury is the closest planet to the Sun."},
  {name:"Venus", distance:8, color:0xffcc00, size:0.8, fact:"Venus has a very thick atmosphere."},
  {name:"Earth", distance:11, color:0x3366ff, size:1, fact:"Earth is our home planet."},
  {name:"Mars", distance:14, color:0xff3300, size:0.7, fact:"Mars is known as the Red Planet."},
  {name:"Jupiter", distance:18, color:0xff9966, size:1.5, fact:"Jupiter is the largest planet in our solar system."},
  {name:"Saturn", distance:22, color:0xffcc99, size:1.2, fact:"Saturn is famous for its rings."},
  {name:"Uranus", distance:26, color:0x66ccff, size:1, fact:"Uranus rotates on its side."},
  {name:"Neptune", distance:30, color:0x3366ff, size:1, fact:"Neptune has strong winds."},
];
const planets = [];
planetsData.forEach(data=>{
  const mesh = new THREE.Mesh(new THREE.SphereGeometry(data.size,32,32),
                               new THREE.MeshStandardMaterial({color:data.color}));
  mesh.position.x = data.distance;
  mesh.userData = {name:data.name, fact:data.fact};
  scene.add(mesh);
  planets.push(mesh);
});
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
function onClick(event){
  mouse.x = (event.clientX/window.innerWidth)*2-1;
  mouse.y = -(event.clientY/window.innerHeight)*2+1;
  raycaster.setFromCamera(mouse,camera);
  const intersects = raycaster.intersectObjects(planets);
  if(intersects.length>0){
    const planet = intersects[0].object;
    document.getElementById("planetInfo").innerText = `${planet.userData.name}: ${planet.userData.fact}`;
  }
}
window.addEventListener('click', onClick);

function animate(){
  requestAnimationFrame(animate);
  planets.forEach((planet,i)=>{
    planet.position.x = planetsData[i].distance * Math.cos(Date.now()*0.001*(i+1));
    planet.position.z = planetsData[i].distance * Math.sin(Date.now()*0.001*(i+1));
  });
  renderer.render(scene,camera);
}
animate();
window.addEventListener('resize',()=>{
  camera.aspect = canvas.clientWidth/canvas.clientHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(canvas.clientWidth,canvas.clientHeight);
});

async function loadRoverPhotos(){
  try{
    const res = await fetch(`https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?sol=1000&api_key=${apiKey}`);
    const data = await res.json();
    const gallery = document.getElementById("roverImages");
    data.photos.slice(0,6).forEach(photo=>{
      const img = document.createElement("img");
      img.src = photo.img_src;
      img.className = "roverImg";
      img.title = `Rover: ${photo.rover.name} | Camera: ${photo.camera.full_name}`;
      gallery.appendChild(img);
    });
  }catch(err){
    console.error(err);
  }
}
loadRoverPhotos();

const quizData = [
  {q:"Which planet is the Red Planet?", options:["Mars","Jupiter","Venus","Saturn"], answer:"Mars"},
  {q:"Which planet has rings?", options:["Earth","Saturn","Mars","Mercury"], answer:"Saturn"},
  {q:"Which is the closest planet to the Sun?", options:["Venus","Mercury","Earth","Mars"], answer:"Mercury"}
];
let currentQ = 0;
let score = 0;

function showQuestion(){
  const qDiv = document.getElementById("question");
  const optionsDiv = document.getElementById("options");
  qDiv.innerText = quizData[currentQ].q;
  optionsDiv.innerHTML = "";
  quizData[currentQ].options.forEach(opt=>{
    const btn = document.createElement("button");
    btn.innerText = opt;
    btn.onclick = ()=>checkAnswer(opt);
    optionsDiv.appendChild(btn);
  });
  document.getElementById("quizResult").innerText="";
  document.getElementById("nextQ").style.display="none";
}
function checkAnswer(opt){
  if(opt===quizData[currentQ].answer){
    score++;
    document.getElementById("quizResult").innerText="✅ Correct!";
  }else{
    document.getElementById("quizResult").innerText=`❌ Wrong! Answer: ${quizData[currentQ].answer}`;
  }
  document.getElementById("nextQ").style.display="inline-block";
}
document.getElementById("nextQ").onclick = ()=>{
  currentQ++;
  if(currentQ<quizData.length) showQuestion();
  else document.getElementById("question").innerText = `Quiz Finished! Score: ${score}/${quizData.length}`;
};
showQuestion();
</script>

</body>
</html>